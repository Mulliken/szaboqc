\chapter{$1s$原初高斯函数的积分计算方法}
\label{appendix:a}


大多数分子计算使用固定的分子坐标系，使得基函数以该坐标系中的位置矢量
$\bo{R}_A$为中心，如\autoref{figA.1}所示。一个以$\bo{R}_A$为中心的
位置矢量$\bo{r}$的值将会依赖于$\bo{r}-\bo{R}_A$，因此我们可以写一个一般化的基函数
$\phi_\mu(\bo{r}-\bo{R}_A)$来代表它是以$\bo{R}_A$为中心的。在一个分子计算的过程中
我们需要计算数量庞大的包含不同中心$\phi_\mu(\bo{r}-\bo{R}_A)$的单电子和双电子积分。
如果我们使用的基函数包括四个或者更多的中心，那么我们的双电子积分将会包含$1-$、$2-$、$3-$和
$4-$中心积分。核吸引势积分最多只能处理到三中心。这些多中心（超过$2$）的积分对于Slater型函数
来说非常难以处理，但是对于Gaussian型函数来说处理起来相对简单。因此许多多原子计算使用Gaussian函数。
\begin{figure}[h]
	\begin{tikzpicture}[scale=2,inner sep=0,arrows=-latex]
		\draw (0,0)--(0,2);
		\draw (0,0)--(-1.2,-1.2);
		\draw (0,0)--(2,0);
		\draw (2,1) circle[radius=0.3];
		\node (A) at (2,1) {\bf A};
		\node (i) at (.7,1.8) {} ;
		\fill (i) circle(1pt) ;
		\draw (0,0)--node[right=13pt]{$\mathbf{R_A}$}(A);
		\draw (0,0)--node[right=5pt]{$\mathbf{r}$}(i);
		\draw (A)--node[right=.2cm]{$\mathbf{r-R_A}$}(i);
	\end{tikzpicture}
	\caption{分子坐标系}
	\label{figA.1}
\end{figure}

% \newpage
在高斯函数的计算中，收缩型的高斯基函数$\phi_\mu^{CGF}$一般由一系列的原初高斯函数
$g\equiv\phi_p^{GF}$（见\autoref{3.283}或\autoref{3.212}） 展开，因此我们只需要考虑
计算这些原初函数之间的积分即可。收缩函数$\phi_\mu^{CGF}$的积分只需要通过对原初函数的积分
用恰当的收缩系数进行求和就能得到。一般常用$1s$、$2p$、$3d$等原初高斯函数，因为任何$s$、$p$、
$d$的函数能够类似的用这些高斯函数展开。这里我们仅考虑$1s$原初高斯函数积分的计算。
Shavitt 
\endnote{I.Shavitt,The Gaussian function in calculations of statistical mechanics and quantummechanics,in \textit{Methods in Computational Physics}
,B.Aledr,S.Fernbach,and M.Rotenberg (Eds.),Academic Press,New York,1963.}
已经给出了一个相似的但是可以互通有无的关于高斯函数积分计算的讨论。包含$p$、$d$等类似函数的积分
可以通过把我们结果对中心$\bo{R}_A$、$\bo{R}_B$等在笛卡尔坐标系中的坐标进行微分得到。但是，
高角量子数的积分计算通过基于Rys多项式的新方法更高效的实现。\endnote{
M. Dupuis,J. Rys,and H. King,Evaluation of molecular integrals over Gaussian basis functions,\textit{J. Chem. Phys.} \textbf{65}:111 (1976).}

以$\bo{R}_A$未归一化的$1s$原初高斯函数为
\begin{align}
	\label{A.1}
	\tilde{g}_{1s}(\bo{r}-\bo{R}_A)=e^{-\alpha\lvert \bo{r}-\bo{R}_A \rvert ^2}
\end{align}
我们将用$\alpha$、$\beta$、$\gamma$和$\delta$分别表示$\bo{R}_A$、
$\bo{R}_B$、$\bo{R}_C$、$\bo{R}_D$的轨道指数。高斯函数能够简化多中心电子积分的原因是
两个不同中心的$1s$高斯函数的乘积可以成比例的化成1个在第三个中心的$1s$高斯函数。因此
\begin{align}
	\label{A.2}
	\tilde{g}_{1s}(\bo{r}-\bo{R}_A)\tilde{g}_{1s}(\bo{r}-\bo{R}_B)
	=\tilde{K}\tilde{g}_{1s}(\bo{r}-\bo{R}_P)
\end{align}
其中，比例系数$\tilde{K}$为
\begin{align}
	\label{A.3}
    \tilde{K}=\exp[-\alpha\beta/(\alpha+\beta)\lvert \bo{r}-\bo{R}_A \rvert ^2]
\end{align}
第三个中心$P$落在中心$A$和$B$的连线上，
\begin{align}
	\label{A.4}
	\bo{R}_P=(\alpha\bo{R}_A+\beta \bo{R}_B)/(\alpha+\beta)
\end{align}
中心在$\bo{R}_P$的新高斯函数的指数为
\begin{align}
	\label{A.5}
	p=\alpha+\beta
\end{align}
因此对于$1s$高斯函数的任何2-中心分布，例如，两个不同中心的函数的乘积，能够马上转化成一个单中心
分布的高斯函数。我们现在计算任何从头算计算过程都需要的仅收缩$1s$原初高斯函数的基本积分。我们将
计算未归一化的函数的积分，并且如果我们需要归一化的函数的积分，我们可以简单的乘一个合适的归一化
常数来得到它。

首先考虑2-中心的重叠积分
\begin{align}
	\label{A.6}
	(A|B)=\int \emph{d}\bo{r}_1\,\tilde{g}_{1s}(\bo{r}_1-\bo{R}_A)\tilde{g}_{1s}(\bo{r}_1-\bo{R}_B)
\end{align}
通过\autoref{A.2},我们马上得到
\begin{align}
	\label{A.7}
	(A|B)=\tilde{K}\int \emph{d}\bo{r}_1\,\tilde{g}_{1s}(\bo{r}_1-\bo{R}_P)
	=\tilde{K}\int \emph{d}\bo{r}_1\, \exp[-p\lvert \bo{r}_1-\bo{R}_P \rvert ^2]
\end{align}
如果我们使$\bo{r}=\bo{r}_1-\bo{R}_p$并且$\emph{d}\bo{r}\,=\emph{d}\bo{r}_1\,$,则
\begin{align}
	\label{A.8}
	(A|B)=\tilde{K}\int \emph{d}\bo{r}\,\,e^{-p\bo{r}^2}=4\pi\tilde{K}\int_0^{\infty} \emph{d}r\,r^2e^{-pr^2}
\end{align}
最后一个积分的值恰好是$(\pi/p)^{\frac{3}{2}}/{4\pi}$，所以
\begin{align}
	\label{A.9}
	(A|B)=[pi/(\alpha+\beta)]^{\frac{3}{2}}\exp[-\alpha\beta/(\alpha+\beta)\lvert \bo{R}_A-\bo{R}_B \rvert ^2]
\end{align}

动能积分为
\begin{align}
	\label{A.10}
	(A|-\frac{1}{2}\nabla^2|B)=\int \emph{d}\bo{r}_1\,\tilde{g}_{1s}(\bo{r}_1-\bo{R}_A)(-\frac{1}{2}\nabla_1^2)\tilde{g}_{1s}(\bo{r}_1-\bo{R}_B)
\end{align}
在算符$\nabla_1^2$作用完成后，上式能够通过非常类似的方式进行计算，得到
\begin{align}
	\label{A.11}
	(A|-\frac{1}{2}\nabla^2|B)=&\alpha\beta/(\alpha+\beta)[3-2\alpha\beta/(\alpha+\beta)\lvert \bo{R}_A-\bo{R}_B \rvert ^2][\pi/(\alpha+\beta)]^{\frac{3}{2}}\nonumber\\
	&\times\exp[-\alpha\beta/(\alpha+\beta)\lvert \bo{R}_A-\bo{R}_B \rvert ^2]
\end{align}

为了计算核吸引势能积分和双电子排斥积分，现在我们在这里介绍一种强力的并常用的，对于计算积分
尤其是我们将要讨论的类型的积分往往有效的方法。这种方法是将每一个我们需要积分的变量替换为它的
傅里叶变换的形式。如果我们给定了一个矢量$\bo{r}$的函数$f(\bo{r})$,那么它的三维坐标傅里叶变换
$F(\bo{k})$定义为
\begin{align}
	\label{A.12}
	F(\bo{k})=\int \emph{d}\bo{r}\,f(\bo{r})e^{-i\bo{k}\bo{r}}
\end{align}
其中矢量$\bo{k}$是变换变量。傅里叶积分定理说明
\begin{align}
	\label{A.13}
	f(\bo{r})=(2\pi)^{-3}\int \emph{d}\bo{k}\,F(\bo{k})e^{i\bo{k}\bo{r}}
\end{align}
$F(\bo{k})$和$f(\bo{r})$被称为一个傅里叶变换对。所有的我们将要用到的傅里叶变换对都在
\autoref{tA.1}给出。特别的，傅里叶表示下的三维坐标狄拉克$delta$函数是
\begin{align}
	\label{A.14}
	\delta(\bo{r}_1-\bo{r}_2)=(2\pi)^{-3}\int \emph{d}\bo{k}\,F(\bo{k})e^{i\bo{k}(\bo{r}_1-\bo{r_2})}
\end{align}

\begin{table}[h!] \large
	\label{tA.1}
	\caption{Fourier transform pairs}
	\centering
	\begin{tabular}{lll}
		\hline \\
		$f(\bm{r})$ & ~~~~ ~~~~& $F(\bm{k})$ \\ \hline
		$\frac{1}{r}$&  ~~~~ ~~~~& $\frac{4\pi}{k^2}$ \\
		\\
		$e^{-\alpha^2}$ & ~~~~ ~~~~ & $(\frac{\pi}{\alpha})^{\frac{3}{2}}e^{-k^2/{4\alpha}}$\\
		\\
		$\delta(\bo{r})$& ~~~~ ~~~~ &1
	\\ \hline
	\end{tabular}

\end{table}
\newpage
\theendnotes
\addcontentsline{toc}{section}{注释}
